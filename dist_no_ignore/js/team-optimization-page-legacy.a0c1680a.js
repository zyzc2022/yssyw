"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[121],{38755:function(e,t,l){var a=l(10311);const n={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},o=(0,a.createElementVNode)("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),r=[o];function c(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)("svg",n,r)}t["Z"]={name:"ep-plus",render:c}},2875:function(e,t,l){l.d(t,{YK:function(){return n},$o:function(){return r},eH:function(){return c}});l(33948);var a=l(86315);l(60285),l(41637);function n(e,t){const a=new Worker(new URL(l.p+l.u(674),l.b));return new Promise(((l,n)=>{a.onmessage=function(n){const o=n.data.type;if("ready"===o)a.postMessage({input:e,artifacts:t});else if("result"===o){const e=n.data.data.result;a.terminate(),l(e)}},a.onerror=function(e){n(e)}}))}l(94631);var o=l(55979);function r(e,t,a=12e4){const n=new Worker(new URL(l.p+l.u(223),l.b)),r=(0,o.p$)(e);return new Promise(((e,l)=>{const o=setTimeout((()=>{l("计算超时")}),a);n.onmessage=l=>{if("ready"===l.data.type)n.postMessage({potentialFunctionInterface:r,artifacts:t});else{const t=l.data.data.results;clearTimeout(o),e(t)}},n.onerror=e=>{l("计算发生错误："+e.message),clearTimeout(o)}})).finally((()=>{n.terminate()}))}async function c(e,t,l,n){const o=await(0,a.n)();return o.CommonInterface.get_artifacts_rank_by_character(e,t,l,n)}},49531:function(e,t,l){l.d(t,{Z:function(){return u}});var a=l(10311),n=l(59818),o=(l(50657),l(60096),l(33948),l(7502)),r={__name:"SelectPreset",props:{modelValue:String},setup(e){const t=(0,o.B)(),l=(0,a.computed)((()=>{let e=[];for(let l of t.allFlat.value)e.push(l.name);return e}));return(t,o)=>{const r=n.BT,c=n.km;return(0,a.openBlock)(),(0,a.createBlock)(c,{"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t.$emit("update:modelValue",e))},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(l),(e=>((0,a.openBlock)(),(0,a.createBlock)(r,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["model-value"])}}};const c=r;var u=c},71797:function(e,t,l){l.r(t),l.d(t,{default:function(){return H}});var a=l(79509),n=l(89804),o=l(10311),r=l(35267),c=(l(45177),l(19651)),u=(l(71683),l(31838)),i=(l(87228),l(7810)),s=(l(44163),l(77049)),m=(l(75915),l(21491)),d=(l(72142),l(28785)),p=(l(9638),l(33948),l(67637)),f=l(2875),v=l(70797),g=l(80377),k=l(33996),h=l(49531),V=l(6643),y=l(68095),B=l(7502),w=l(86315),b=l(55979),x=l(74148),N=l(38755),_=l(42894),E=l(19344),C=l(91919);const T=e=>((0,o.pushScopeId)("data-v-2110fb4b"),e=e(),(0,o.popScopeId)(),e),z=(0,o.createTextVNode)("In theory, you should not see this"),S={key:1,style:{padding:"0 20px"}},Z={style:{"margin-bottom":"12px"}},P={style:{display:"flex","justify-content":"space-between","align-items":"center"},class:"member-header"},U={class:"team-title"},D={class:"common-title2"},L={class:"common-title2"},F={class:"result-item-top"},I=T((()=>(0,o.createElementVNode)("div",{class:"result-item-buttons"},null,-1))),M={class:"result-item-content"},$={key:1,style:{display:"flex","justify-content":"center"}};var R=(0,o.defineComponent)({__name:"TeamOptimizationPage",async setup(e){let t,l;const{t:T}=(0,C.QT)(),R=(0,y.n)(),j=(0,B.B)(),A=([t,l]=(0,o.withAsyncContext)((()=>(0,w.n)())),t=await t,l(),t),H=(0,o.ref)([null]),Y=(0,o.ref)([0]),K=8;function O(){H.value.length!==K?(H.value.push(null),Y.value.push(0)):(0,a.z8)({message:"最多支持8个成员",type:"error"})}function W(e){1!==H.value.length&&(H.value.splice(e,1),Y.value.splice(e,1))}const q=(0,o.computed)((()=>{let e=[];for(let t of H.value.values())if(t){const l=j.presets.value[t];l&&e.push(l)}return e})),G=(0,o.ref)([]),Q=(0,o.ref)(0),J=(0,o.computed)((()=>0===G.value.length?null:G.value[Q.value]));function X(e){Q.value=e-1}const ee=(0,o.ref)(!1),te=(0,o.ref)(null);function le(e){let t=[];if(J.value){const l=Object.values(J.value[e]),a=[];for(let e of l){const t=R.artifacts.value.get(e);t&&a.push(t)}t=a.map((e=>(0,p.Lz)(e)))}return{character:q.value[e].item.character,weapon:q.value[e].item.weapon,buffs:q.value[e].item.buffs,artifacts:t}}async function ae(e){const t=le(e);te.value=await A.CommonInterface.get_attribute(t),ee.value=!0}function ne(e){R.toggleArtifact(e)}const oe=(0,o.computed)((()=>{let e=[];for(let t of R.artifacts.value.values())t.level>=16&&!t.omit&&e.push(t);return e})),re=(0,o.computed)((()=>oe.value.map(p.Lz))),ce=(0,o.computed)((()=>q.value.map((e=>(0,v.DR)(e.item))))),ue={mva_step:5,work_space:1e3,max_re_optimize:5,max_search:1e6,count:1e3},ie=(0,o.computed)((()=>({single_interfaces:ce.value,weights:Y.value,hyper_param:ue})));function se(){const e=q.value.length===H.value.length;if(!e)return void(0,a.z8)({message:"请选择计算预设",type:"error"});const t=(0,b.p$)(ie.value),l=re.value,o=n.kN.service({text:"莫娜占卜中（可能需要数分钟）",lock:!0,fullscreen:!0});(0,f.YK)(t,l).then((e=>{G.value=e.artifacts,Q.value=0})).catch((e=>{var t;(0,a.z8)({message:`计算过程发生错误：${null!==(t=e.message)&&void 0!==t?t:e}`,type:"error"}),console.error(e)})).finally((()=>{o.close()}))}return(e,t)=>{const l=d.GT,a=m.zd,n=s.mi,p=i.BM,f=u.Dv,v=c.d6,y=r.dq;return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(a,{title:(0,o.unref)(T)("misc.panel"),modelValue:ee.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ee.value=e),size:(0,o.unref)(g.B)?"30%":"100%"},{default:(0,o.withCtx)((()=>[te.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",S,[(0,o.createVNode)((0,o.unref)(V.Z),{attribute:te.value},null,8,["attribute"])])):((0,o.openBlock)(),(0,o.createBlock)(l,{key:0},{default:(0,o.withCtx)((()=>[z])),_:1}))])),_:1},8,["title","modelValue","size"]),(0,o.createVNode)(y,{gutter:16},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{md:6,sm:24,class:"mona-scroll-hidden left"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",Z,[(0,o.createVNode)(n,{type:"primary",icon:(0,o.unref)(x.Z),onClick:se},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(T)("teamPage.start")),1)])),_:1},8,["icon"]),(0,o.createVNode)(n,{icon:(0,o.unref)(N.Z),onClick:O},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(T)("teamPage.add")),1)])),_:1},8,["icon"])]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(H.value,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"member-item"},[(0,o.createElementVNode)("div",P,[(0,o.createElementVNode)("p",U,(0,o.toDisplayString)((0,o.unref)(T)("teamPage.member"))+(0,o.toDisplayString)(t+1),1),(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{circle:"",text:"",icon:(0,o.unref)(_.Z),onClick:e=>W(t),style:{color:"white"}},null,8,["icon","onClick"])])]),(0,o.createElementVNode)("p",D,(0,o.toDisplayString)((0,o.unref)(T)("misc.preset")),1),(0,o.createVNode)(h.Z,{modelValue:H.value[t],"onUpdate:modelValue":e=>H.value[t]=e},null,8,["modelValue","onUpdate:modelValue"]),(0,o.createElementVNode)("p",L,(0,o.toDisplayString)((0,o.unref)(T)("teamPage.weight")),1),(0,o.createVNode)(p,{modelValue:Y.value[t],"onUpdate:modelValue":e=>Y.value[t]=e,min:0,max:1,step:.01,"show-input":!0,style:{"padding-left":"8px"}},null,8,["modelValue","onUpdate:modelValue","step"])])))),128))])),_:1}),(0,o.createVNode)(f,{md:18,sm:24,class:"mona-scroll-hidden right"},{default:(0,o.withCtx)((()=>[(0,o.unref)(J)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(v,{"model-value":Q.value+1,"onUpdate:modelValue":X,min:1,max:G.value.length,style:{"margin-bottom":"12px"}},null,8,["model-value","max"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(J),((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"result-item"},[(0,o.createElementVNode)("div",F,[(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{icon:(0,o.unref)(E.Z),circle:"",text:"",title:(0,o.unref)(T)("teamPage.showStat"),onClick:e=>ae(t)},null,8,["icon","title","onClick"])]),I]),(0,o.createElementVNode)("div",M,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(J)[t],(e=>((0,o.openBlock)(),(0,o.createBlock)(k.Z,{key:e,item:(0,o.unref)(R).artifacts.value.get(e),buttons:!0,"lock-button":!0,"delete-button":!1,"edit-button":!1,onToggle:t=>ne(e)},null,8,["item","onToggle"])))),128))])])))),128))],64)):((0,o.openBlock)(),(0,o.createElementBlock)("div",$,[(0,o.createVNode)(l)]))])),_:1})])),_:1})])}}}),j=l(83744);const A=(0,j.Z)(R,[["__scopeId","data-v-2110fb4b"]]);var H=A}}]);